```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- å¾®ä¿¡åˆ†äº«å…ƒæ•°æ® -->
    <title>å¡”ç½—è¿·å®«ï¼šMBTIäººæ ¼è§‰é†’</title>
    <meta name="description" content="æµ‹æµ‹ä½ çš„MBTIäººæ ¼ï¼Œåœ¨å¡”ç½—å¹»å¢ƒä¸­æŒ‘æˆ˜å‘½è¿ï¼">
    
    <style>
        :root { --p-color: #00ffcc; --bg-dark: #0a0a0a; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background: var(--bg-dark); color: #eee; 
            font-family: 'Courier New', Courier, monospace; 
            margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center;
            height: 100vh; overflow: hidden;
        }

        /* é€‰è§’ç•Œé¢ */
        #selection-screen { 
            width: 100%; height: 100%; display: flex; flex-direction: column; 
            align-items: center; justify-content: center; 
            background: radial-gradient(circle, #1a1a2e 0%, #000 100%);
            padding: 20px; text-align: center;
        }
        .char-list { display: flex; flex-direction: column; gap: 15px; width: 100%; max-width: 300px; }
        .char-card { 
            padding: 15px; border: 2px solid #444; background: #111; 
            border-radius: 8px; cursor: pointer;
        }
        .char-card:active { transform: scale(0.98); border-color: var(--p-color); }

        /* æ¸¸æˆä¸»ç•Œé¢ */
        #game-ui { 
            display: none; width: 100%; max-width: 500px; height: 100%;
            padding: 15px; flex-direction: column;
        }

        .stats-header { 
            display: flex; justify-content: space-between; font-size: 14px;
            padding: 10px; background: #111; border: 1px solid #333; margin-bottom: 10px;
        }

        .boss-box { 
            text-align: center; padding: 15px; border: 2px solid #ff4444; 
            background: #1a0000; margin-bottom: 10px; position: relative;
        }
        .hp-bar { height: 6px; background: #300; margin-top: 8px; }
        .hp-fill { height: 100%; background: #ff4444; transition: width 0.3s; }

        .log-window { 
            flex-grow: 1; overflow-y: auto; background: #000; border: 1px solid #222;
            padding: 8px; font-size: 12px; margin-bottom: 10px; color: #aaa;
        }

        .controls { margin-bottom: 10px; display: flex; justify-content: center; }
        .btn-redraw { 
            background: #333; color: #fff; border: 1px solid #666; 
            padding: 8px 20px; border-radius: 20px; font-size: 12px;
        }

        .hand { 
            display: flex; gap: 8px; justify-content: center; 
            padding-bottom: 20px;
        }
        .card { 
            width: 31%; aspect-ratio: 2/3; border: 1px solid #444; 
            background: #111; border-radius: 6px; display: flex;
            flex-direction: column; align-items: center; justify-content: center;
            text-align: center; font-size: 11px; padding: 5px;
        }
        .card:active { background: #222; border-color: var(--p-color); }

        /* é—ç‰©å¼¹çª— */
        #relic-ui {
            display: none; position: fixed; top: 20%; left: 5%; width: 90%;
            background: #000; border: 2px solid #ffd700; padding: 20px;
            z-index: 100; text-align: center; box-shadow: 0 0 30px #000;
        }
        .relic-opt { 
            display: block; width: 100%; padding: 12px; border: 1px solid #ffd700;
            margin: 10px 0; color: #ffd700;
        }
    </style>
</head>
<body>

    <!-- é€‰æ‹©ç•Œé¢ -->
    <div id="selection-screen">
        <h2 style="color: #ffd700; margin-bottom: 5px;">å¡”ç½—è¿·å®«</h2>
        <p style="font-size: 12px; color: #888;">é€‰æ‹©ä½ çš„MBTIäººæ ¼è¿›å…¥å¹»å¢ƒ</p>
        <div class="char-list">
            <div class="char-card" onclick="startGame('INTP')" style="--p-color: #ff00ff;">
                <b style="color:#ff00ff">INTP éšå£«</b><br><small>é€»è¾‘æ¨æ¼” Â· çˆ†å‘ä¼¤å®³</small>
            </div>
            <div class="char-card" onclick="startGame('ENFP')" style="--p-color: #ffea00;">
                <b style="color:#ffea00">ENFP æ„šè€…</b><br><small>çµæ„Ÿéšæœº Â· æé™ç¿»ç›˜</small>
            </div>
            <div class="char-card" onclick="startGame('ISFP')" style="--p-color: #00ffcc;">
                <b style="color:#00ffcc">ISFP æ˜Ÿæ˜Ÿ</b><br><small>å®¡ç¾èŠ‚å¥ Â· æŒç»­æ²»æ„ˆ</small>
            </div>
        </div>
        <p style="margin-top: 20px; font-size: 10px; color: #444;">å¾®ä¿¡ç«¯ä¼˜åŒ–ç‰ˆ v2.0</p>
    </div>

    <!-- æ¸¸æˆç•Œé¢ -->
    <div id="game-ui">
        <div class="stats-header">
            <div><b id="p-name"></b> HP:<span id="p-hp"></span></div>
            <div style="color: var(--p-color)"><span id="res-name"></span>:<span id="p-res"></span></div>
            <div>å…³å¡:<span id="level"></span></div>
        </div>

        <div class="boss-box">
            <div id="boss-display" style="font-size: 14px; color: #ff4444;">BOSS</div>
            <div style="font-size: 12px;">HP: <span id="b-hp"></span>/<span id="b-max-hp"></span></div>
            <div class="hp-bar"><div id="b-fill" class="hp-fill"></div></div>
        </div>

        <div class="log-window" id="log"></div>

        <div class="controls">
            <button class="btn-redraw" onclick="redrawHand()">ğŸ”„ é‡æ„æ‰‹ç‰Œ (-5 HP)</button>
        </div>

        <div class="hand" id="hand"></div>

        <div id="relic-ui">
            <h3 style="color:#ffd700">è·å¾—å¡”ç½—é—ç‰©</h3>
            <div id="relic-list"></div>
        </div>
    </div>

<script>
    const CHAR_DATA = {
        INTP: { hp: 80, res: "é€»è¾‘", color: "#ff00ff", cards: [
            { n: "æ¨æ¼”", d: 8, c: 1, desc: "+1é€»è¾‘" },
            { n: "åˆ†æ", d: 4, c: 2, desc: "+2é€»è¾‘" },
            { n: "ç»“è®º", d: 22, c: -3, desc: "-3é€»è¾‘çˆ†å‘" }
        ]},
        ENFP: { hp: 100, res: "çƒ­æƒ…", color: "#ffea00", cards: [
            { n: "ç«èŠ±", d: [5, 22], c: 1, desc: "+1çƒ­æƒ…" },
            { n: "æ¼«æ¸¸", d: 10, c: 1, desc: "+1çƒ­æƒ…" },
            { n: "ç‹‚æƒ³", d: [2, 45], c: -2, desc: "-2çƒ­æƒ…çˆ†å‘" }
        ]},
        ISFP: { hp: 95, res: "æµ", color: "#00ffcc", cards: [
            { n: "ç´ æ", d: 8, c: 1, desc: "+1æµ" },
            { n: "è°ƒè‰²", d: 6, c: 1, desc: "+1æµ/å›è¡€3" },
            { n: "æ°ä½œ", d: 15, c: -1, desc: "-1æµç¨³å¥" }
        ]}
    };

    let player = {}, boss = {}, level = 1;

    // å­˜æ¡£åŠŸèƒ½
    function save() {
        const state = { level, p_hp: player.hp, type: player.type, p_res: player.res };
        localStorage.setItem('mbti_tarot_save', JSON.stringify(state));
    }

    function startGame(type) {
        const d = CHAR_DATA[type];
        player = { type, hp: d.hp, maxHp: d.hp, res: 0, resName: d.res, color: d.color, baseCards: d.cards };
        document.documentElement.style.setProperty('--p-color', d.color);
        document.getElementById('selection-screen').style.display = 'none';
        document.getElementById('game-ui').style.display = 'flex';
        initLevel();
    }

    function initLevel() {
        boss.maxHp = 50 + (level - 1) * 35;
        boss.hp = boss.maxHp;
        boss.dmg = 7 + (level - 1) * 4;
        boss.n = ["æ„šè€…", "æ•™çš‡", "æ‹äºº", "éšå£«", "æ­»ç¥"][Math.min(level-1, 4)];
        addLog(`--- ç¬¬ ${level} å…³ï¼š${boss.n} ---`, "#ffd700");
        updateUI();
        initHand();
    }

    function addLog(m, c = "#aaa") {
        const l = document.getElementById('log');
        l.innerHTML += `<div style="color:${c}">> ${m}</div>`;
        l.scrollTop = l.scrollHeight;
    }

    function redrawHand() {
        if(player.hp > 5) {
            player.hp -= 5;
            addLog("å¼ºåˆ¶é‡æ„ï¼šæ¶ˆè€—5ç‚¹HPã€‚", "#ff4444");
            initHand();
            updateUI();
        }
    }

    function initHand() {
        const h = document.getElementById('hand');
        h.innerHTML = '';
        let cards = [];
        for(let i=0; i<3; i++) cards.push({...player.baseCards[Math.floor(Math.random()*3)]});
        
        // æ­»é”æ£€æŸ¥
        if(!cards.some(c => c.c >= 0 || player.res >= Math.abs(c.c))) cards[0] = {...player.baseCards[0]};

        cards.forEach(c => {
            const el = document.createElement('div');
            el.className = 'card';
            const canPay = c.c >= 0 || player.res >= Math.abs(c.c);
            if(!canPay) el.style.opacity = "0.3";
            
            let dmgVal = Array.isArray(c.d) ? `${c.d[0]}-${c.d[1]}` : c.d;
            el.innerHTML = `<b style="font-size:13px">${c.n}</b><br><span style="color:#888">${c.desc}</span><hr style="width:80%;border:0;border-top:1px solid #333">
                            <span style="color:#ff4444">âš”ï¸${dmgVal}</span><br>
                            <span style="color:var(--p-color)">${c.c>=0?'+':''}${c.c}${player.resName}</span>`;
            el.onclick = () => playTurn(c);
            h.appendChild(el);
        });
    }

    function playTurn(c) {
        if(c.c < 0 && player.res < Math.abs(c.c)) return;

        player.res += c.c;
        let d = Array.isArray(c.d) ? Math.floor(Math.random()*(c.d[1]-c.d[0]+1))+c.d[0] : c.d;

        // ç‰¹æ€§é€»è¾‘
        if(player.type === 'ENFP' && player.res >= 3 && Math.random() > 0.6) {
            d *= 2; addLog("âœ¨çµæ„Ÿçˆ†å‘ï¼åŒå€ä¼¤å®³ï¼", "#ffea00");
        }
        if(player.type === 'ISFP' && c.n === "è°ƒè‰²") player.hp = Math.min(player.maxHp, player.hp + 3);

        boss.hp -= d;
        addLog(`${c.n} é€ æˆ ${d} ç‚¹ä¼¤å®³`, "#fff");

        if(boss.hp <= 0) { win(); return; }

        // Bossåå‡»
        setTimeout(() => {
            player.hp -= boss.dmg;
            addLog(`${boss.n} åå‡»é€ æˆ ${boss.dmg} ä¼¤å®³`, "#ff4444");
            updateUI();
            if(player.hp <= 0) { alert("æˆ˜æ–—å¤±è´¥ï¼Œçµé­‚ç ´ç¢..."); location.reload(); }
            save();
        }, 300);

        initHand();
        updateUI();
    }

    function updateUI() {
        document.getElementById('p-name').innerText = player.type;
        document.getElementById('p-hp').innerText = player.hp;
        document.getElementById('res-name').innerText = player.resName;
        document.getElementById('p-res').innerText = player.res;
        document.getElementById('b-hp').innerText = boss.hp;
        document.getElementById('b-max-hp').innerText = boss.maxHp;
        document.getElementById('b-fill').style.width = (boss.hp/boss.maxHp*100) + "%";
        document.getElementById('boss-display').innerText = `[ ${boss.n} ]`;
        document.getElementById('level').innerText = level;
    }

    function win() {
        addLog(`æˆ˜èƒœäº† ${boss.n}ï¼`, "#ffd700");
        document.getElementById('relic-ui').style.display = 'block';
        const list = document.getElementById('relic-list');
        list.innerHTML = '';
        const relics = [{n:"é­”æœ¯å¸ˆ",d:"æœ€å¤§è¡€é‡+20"},{n:"æˆ˜è½¦",d:"èµ„æºè·å–+1"},{n:"æ­£ä¹‰",d:"å›è¡€5ç‚¹"}];
        relics.forEach(r => {
            const d = document.createElement('div');
            d.className = 'relic-opt';
            d.innerHTML = `<b>${r.n}</b><br><small>${r.d}</small>`;
            d.onclick = () => {
                if(r.n === "é­”æœ¯å¸ˆ") player.maxHp += 20;
                if(r.n === "æ­£ä¹‰") player.hp = Math.min(player.maxHp, player.hp+5);
                level++;
                document.getElementById('relic-ui').style.display = 'none';
                initLevel();
            };
            list.appendChild(d);
        });
    }
</script>
</body>
</html>
```